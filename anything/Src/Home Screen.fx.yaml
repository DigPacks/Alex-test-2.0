"'Home Screen' As screen":
    OnVisible: |-
        =UpdateContext({locSortColumn:"First Name", locSortOrder:SortOrder.Ascending,locSortColumnAudit:"Audit ID", locSortOrderAudit:SortOrder.Ascending, locIconAudit: Icon.ChevronDown, locIcon: Icon.ChevronDown});
        UpdateContext({locSelectedTab:1});UpdateContext({locAlertTab:0})

    cmpTabListHome As cmpTabListResponsive:
        Y: =68

    cmpFooterHome As cmpFooter:
        Y: =743
        ZIndex: =2

    tglEmployees As toggleSwitch:
        FalseFill: =gblBranding.Colors.PrimaryColor2
        FalseText: ="Showing current employees"
        FocusedBorderThickness: =0
        Font: =Font.'Segoe UI'
        Height: =21
        OnUncheck: |
            =Filter(DPM_Members,IsBlank(EndDate))
        Size: =11
        TextPosition: =TextPosition.Left
        TrueFill: =gblBranding.Colors.PrimaryColor1
        TrueText: ="Showing all employees"
        Width: =230
        X: =485
        Y: =184
        ZIndex: =3

    txtInputSearch As text:
        BorderColor: =gblBranding.Colors.PrimaryColor1
        Default: =""
        DisabledBorderColor: =RGBA(0, 0, 0, 0)
        DisabledColor: =RGBA(0, 0, 0, 0)
        DisabledFill: =RGBA(0, 0, 0, 0)
        FocusedBorderThickness: =2
        Font: =Font.'Segoe UI'
        Height: =32
        HintText: ="ðŸ”Ž Search "
        HoverBorderColor: =gblBranding.Colors.PrimaryColor1
        HoverColor: =
        HoverFill: =RGBA(0, 0, 0, 0)
        PressedBorderColor: =gblBranding.Colors.PrimaryColor1
        RadiusBottomLeft: =2
        RadiusBottomRight: =2
        RadiusTopLeft: =2
        RadiusTopRight: =2
        Size: =11
        X: =116
        Y: =179
        ZIndex: =4

    grpGlyMembers As group:
        Height: =5
        Width: =5
        X: =-1
        Y: =-402
        ZIndex: =4

        glyTemplateBodyMembers As gallery.variableTemplateHeightGallery:
            FocusedBorderColor: =RGBA(98, 100, 167, 1)
            FocusedBorderThickness: =0
            Height: =412
            Items: |-
                =If(
                    locSortColumn = "First Name",
                    Sort(
                        Filter(
                            DPM_Members,
                            (txtInputSearch.Text in LastName || txtInputSearch.Text in FirstName || IsBlank(txtInputSearch.Text)) && (tglEmployees.Value || !tglEmployees.Value && IsBlank(EndDate))
                        ),
                        FirstName,
                        If(
                            locSortOrder = SortOrder.Descending,
                            SortOrder.Descending,
                            SortOrder.Ascending
                        )
                    ),
                    If(
                        locSortColumn = "Last Name",
                        Sort(
                            Filter(
                                DPM_Members,
                                (txtInputSearch.Text in LastName || txtInputSearch.Text in FirstName || IsBlank(txtInputSearch.Text)) && (tglEmployees.Value || !tglEmployees.Value && IsBlank(EndDate))
                            ),
                            LastName,
                            If(
                                locSortOrder = SortOrder.Ascending,
                                SortOrder.Ascending,
                                SortOrder.Descending
                            )
                        ),
                        If(
                            locSortColumn = "Start Date",
                            Sort(
                                Filter(
                                    DPM_Members,
                                    (txtInputSearch.Text in LastName || txtInputSearch.Text in FirstName || IsBlank(txtInputSearch.Text)) && (tglEmployees.Value || !tglEmployees.Value && IsBlank(EndDate))
                                ),
                                StartDate,
                                If(
                                    locSortOrder = SortOrder.Descending,
                                    SortOrder.Descending,
                                    SortOrder.Ascending
                                )
                            )
                        )
                    )
                )
            Layout: =Layout.Vertical
            ShowNavigation: =true
            ShowScrollbar: =false
            TemplateFill: |-
                =//If(Self.IsSelected, ColorFade(gblBranding.Colors.PrimaryColor1 -80%), RGBA(0, 0, 0, 0))
                If(Self.IsSelected, Color.Blue, Color.Red)
            TemplateSize: =recMemberInfo.Height
            Width: =1135
            X: =120
            Y: =299
            ZIndex: =10

            recMemberInfo As rectangle:
                BorderColor: =RGBA(204, 204, 204, 1)
                BorderThickness: =1
                DisplayMode: =DisplayMode.View
                Fill: =If(ThisItem.IsSelected, Color.LightBlue, Color.WhiteSmoke)
                FocusedBorderColor: =RGBA(98, 100, 167, 1)
                Height: =Max(lblStartDate.Height, 50)
                Width: =Parent.TemplateWidth
                ZIndex: =1

            lblFirstName As Label:
                AutoHeight: =false
                Color: =
                DisplayMode: =DisplayMode.Edit
                Font: =Font.'Segoe UI'
                FontSize: =11
                FontWeight: =FontWeight.Normal
                Height: =50
                OnSelect: =Select(Parent)
                PCFTeamsTheme: ="default"
                Text: =ThisItem.FirstName
                VerticalAlignment: =VerticalAlign.Middle
                Width: =73
                X: =12
                Y: =0
                ZIndex: =2

            lblLastName As Label:
                AutoHeight: =false
                Color: =
                DisplayMode: =DisplayMode.Edit
                Font: =Font.'Segoe UI'
                FontSize: =11
                FontWeight: =FontWeight.Normal
                Height: =50
                OnSelect: =Select(Parent)
                PCFTeamsTheme: ="default"
                Text: =ThisItem.LastName
                VerticalAlignment: =VerticalAlign.Middle
                Width: =lblDatetimeHdr.Width
                X: =145
                Y: =0
                ZIndex: =3

            lblStartDate As label:
                Font: =Font.'Segoe UI'
                Height: =50
                OnSelect: =Select(Parent)
                PaddingBottom: =0
                PaddingLeft: =0
                Size: =11
                Text: =Text(ThisItem.StartDate, "dd/mm/yyyy")
                Width: =156
                X: =426
                ZIndex: =4

            lblEndDate As Label:
                AutoHeight: =false
                Color: =
                DisplayMode: =DisplayMode.Edit
                FontSize: =11
                FontWeight: =FontWeight.Normal
                Height: =50
                OnSelect: =Select(Parent)
                PCFTeamsTheme: ="default"
                Text: =Text(ThisItem.EndDate, "dd/mm/yyyy")
                VerticalAlignment: =VerticalAlign.Middle
                Width: =129
                X: =582
                Y: =0
                ZIndex: =5

            btnEdit As button:
                Fill: =RGBA(143, 61, 139, 1)
                Font: =Font.'Segoe UI'
                Height: =28
                HoverFill: =gblBranding.Colors.PrimaryColor2
                OnSelect: |-
                    =UpdateContext({locShowPopup1: true});
                    Patch(
                        DPM_Audits,
                        Defaults(DPM_Audits),
                        {
                            AuditTitle: "Member Viewed",
                            AuditDescription: "" & User().FullName & " viewed " & lblFirstName & " " & lblLastName & " " & txtInputLastName.Value & " on " & Text(
                                Now(),
                                "dd/mm/yyyy  hh:mm"
                            ),
                            CreatedByName: User().FullName,
                            CreatedByEmail: Lower(User().Email),
                            MemberID: "& lblID"
                        }
                    )
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =11
                Text: ="Edit"
                Width: =96
                X: =994
                Y: =10
                ZIndex: =6

            Button1 As button:
                Color: =Color.White
                Fill: =gblBranding.Colors.PrimaryColor1
                Font: =Font.'Segoe UI'
                Height: =28
                HoverFill: =gblBranding.Colors.PrimaryColor2
                OnSelect: |-
                    =UpdateContext({locDocShowPopUp: true})
                RadiusBottomLeft: =2
                RadiusBottomRight: =2
                RadiusTopLeft: =2
                RadiusTopRight: =2
                Size: =11
                Text: ="Employee Documents"
                Width: =180
                X: =793
                Y: =10
                ZIndex: =8

        glyTemplateHdrMembers As gallery.variableTemplateHeightGallery:
            FocusedBorderColor: =RGBA(98, 100, 167, 1)
            FocusedBorderThickness: =2
            Height: =60
            Items: |-
                ={MemberID:"ID",FirstName:"First Name", LastName:"Last Name", StartDate:"Start Date", EndDate:"End Date"}
            Layout: =Layout.Vertical
            ShowScrollbar: =false
            TemplateSize: =40
            Width: =1135
            X: =116
            Y: =239
            ZIndex: =11

            lblNameHdr As Label:
                Color: =
                DisplayMode: =DisplayMode.Edit
                FontSize: =11
                FontWeight: =FontWeight.Semibold
                Height: =35
                OnSelect: =Select(Parent)
                PCFTeamsTheme: ="default"
                Text: =ThisItem.FirstName
                Width: =130
                X: =13
                Y: =0
                ZIndex: =1

            lblDatetimeHdr As Label:
                Color: =
                DisplayMode: =DisplayMode.Edit
                FontSize: =11
                FontWeight: =FontWeight.Semibold
                Height: =35
                OnSelect: =Select(Parent)
                PCFTeamsTheme: ="default"
                Text: =ThisItem.LastName
                Width: =120
                X: =lblNameHdr.X + lblNameHdr.Width
                Y: =0
                ZIndex: =2

            lblDescriptionHdr As Label:
                Color: =
                DisplayMode: =DisplayMode.Edit
                FontSize: =11
                FontWeight: =FontWeight.Semibold
                Height: =35
                OnSelect: =Select(Parent)
                PCFTeamsTheme: ="default"
                Text: =ThisItem.StartDate
                Width: =215
                X: =425
                Y: =0
                ZIndex: =3

            lblColumnHdr As Label:
                Color: =
                DisplayMode: =DisplayMode.Edit
                FontSize: =11
                FontWeight: =FontWeight.Semibold
                Height: =35
                OnSelect: =Select(Parent)
                PCFTeamsTheme: ="default"
                Text: =ThisItem.EndDate
                Width: =176
                X: =590
                Y: =0
                ZIndex: =4

            icoFistnameFilter As icon.Add:
                Color: =If(locSortColumn = "First Name", gblBranding.Colors.PrimaryColor1, gblBranding.Colors.SecondaryColor1)
                DisabledColor: |
                    =RGBA(0, 18, 107, 1)
                Height: =24
                Icon: =If(locSortColumn="First Name",If(locSortOrder= SortOrder.Ascending, Icon.ChevronUp, Icon.ChevronDown),Icon.Sort)
                OnSelect: |-
                    =UpdateContext(
                        {
                            locSortColumn: "First Name",
                            locSortOrder: If(
                                locSortOrder = SortOrder.Ascending,
                                SortOrder.Descending,
                                SortOrder.Ascending
                            )
                           
                        }
                    )
                PressedColor: =gblBranding.Colors.PrimaryColor2
                Width: =24
                X: =90
                Y: =5
                ZIndex: =6

            icoLastnaeFilter As icon.Add:
                Color: =If(locSortColumn = "Last Name", gblBranding.Colors.PrimaryColor1, gblBranding.Colors.SecondaryColor1)
                DisabledColor: =RGBA(0, 18, 107, 1)
                Height: =24
                Icon: =If(locSortColumn="Last Name",If(locSortOrder= SortOrder.Ascending, Icon.ChevronUp, Icon.ChevronDown),Icon.Sort)
                OnSelect: |-
                    =UpdateContext({locSortColumn: "Last Name", locSortOrder: If(locSortOrder = SortOrder.Ascending, SortOrder.Descending, SortOrder.Ascending)})
                Width: =24
                X: =221
                Y: =5
                ZIndex: =7

            icoStartDateFilter As icon.Add:
                Color: =If(locSortColumn = "Start Date", gblBranding.Colors.PrimaryColor1, gblBranding.Colors.SecondaryColor1)
                DisabledColor: =RGBA(0, 18, 107, 1)
                Height: =24
                Icon: =If(locSortColumn="Start Date",If(locSortOrder= SortOrder.Ascending, Icon.ChevronUp, Icon.ChevronDown),Icon.Sort)
                OnSelect: |-
                    =UpdateContext({locSortColumn: "Start Date", Mycolor: true,locSortOrder: If(locSortOrder = SortOrder.Ascending, SortOrder.Descending, SortOrder.Ascending)})
                Width: =24
                X: =499
                Y: =5
                ZIndex: =8

    cmpHomeHeader As cmpHeader:
        pTitle: ="Digpacks Members App - " & Substitute(App.ActiveScreen.Name," Screen","")
        ZIndex: =9

    grpAddMember As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =9

        IcoAddData As icon.Add:
            Color: =RGBA(54, 176, 75, 1)
            Height: =24
            Icon: =Icon.Add
            OnSelect: |-
                =Concurrent(
                    Reset(txtInputFirstName),
                    Reset(txtInputLastName),
                    Reset(calStartDate),
                    Reset(calEndDate)
                );
                UpdateContext({locShowPopup: true})
            Width: =24
            X: =1121
            Y: =186
            ZIndex: =7

        txtAddMember As Text:
            Align: ='TextCanvas.Align'.Center
            AutoHeight: =false
            DisplayMode: =DisplayMode.Edit
            Height: =19
            Size: =15
            Text: ="Add Member"
            VerticalAlign: ="Middle"
            Weight: ='TextCanvas.Weight'.Semibold
            Width: =110
            Wrap: =true
            X: =1145
            Y: =186
            ZIndex: =8

    recHomeUpperSeperator As rectangle:
        Fill: =gblBranding.Colors.PrimaryColor1
        Height: =1
        Width: =1135
        X: =116
        Y: =226
        ZIndex: =13

    grpAddDataForm As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =17

        cmpHomeAddPopup As cmpPopUp:
            pCancel: |-
                =UpdateContext({locShowPopup:false})
            pConfirm: |-
                =Set(gblCurrentMember,Patch(
                    DPM_Members,
                    Defaults(DPM_Members),
                    {
                        FirstName: txtInputFirstName.Value,
                        LastName: txtInputLastName.Value,
                        StartDate: calStartDate.SelectedDate,
                        EndDate: calEndDate.SelectedDate,
                        CreatedByDisplayName: User().FullName,
                        CreatedByEmail: User().Email
                    })
                );
                Patch(
                    DPM_Audits,
                    Defaults(DPM_Audits),
                    {
                        AuditTitle: "Member Added",
                        AuditDescription: "" & User().FullName & " added by " & txtInputFirstName.Value & " " & txtInputLastName.Value & " on  " & Text(Now(), "dd/mm/yyyy  hh:mm") ,
                        CreatedByName: User().FullName,
                        CreatedByEmail: User().Email,
                        MemberID: gblCurrentMember.MemberID
                    }
                ); Set(locAlertTab,1);
                UpdateContext({locShowPopup: false})
            pSubheader: ="Add Data"
            Visible: =locShowPopup
            ZIndex: =23

        "txtInputFirstName As 'Text input'":
            BasePaletteColor: =
            DisplayMode: =DisplayMode.Edit
            FontSize: =0
            Height: =32
            MaxLength: =-1
            Placeholder: =""
            Required: =true
            Type: ="Text"
            ValidationState: ="None"
            Value: =""
            Visible: =locShowPopup
            Width: =320
            X: =306
            Y: =338
            ZIndex: =24

        "txtInputLastName As 'Text input'":
            BasePaletteColor: =
            DisplayMode: =DisplayMode.Edit
            FontSize: =0
            Height: =32
            MaxLength: =-1
            Placeholder: =""
            Required: =true
            Type: ="Text"
            ValidationState: ="None"
            Visible: =locShowPopup
            Width: =320
            X: =734
            Y: =338
            ZIndex: =25

        txtFirstName As Text:
            Align: ="Start"
            AutoHeight: =false
            DisplayMode: =DisplayMode.Edit
            Height: =18
            Size: =15
            Text: |-
                ="First Name:"
            VerticalAlign: ="Middle"
            Visible: =locShowPopup
            Width: =96
            X: =306
            Y: =316
            ZIndex: =26

        txtLastName As Text:
            Align: ="Start"
            AutoHeight: =false
            DisplayMode: =DisplayMode.Edit
            Height: =18
            Size: =15
            Text: |-
                ="Last Name:"
            VerticalAlign: ="Middle"
            Visible: =locShowPopup
            Width: =96
            X: =737
            Y: =313
            ZIndex: =27

        "calStartDate As 'Date picker'":
            AccessibleLabel: =Text(Today(),"dd/mm/yyyy")
            BasePaletteColor: =
            DisplayMode: =DisplayMode.Edit
            EndYear: =2050
            FontSize: =0
            Format: ="Long Abbreviated"
            Height: =32
            IsEditable: =false
            Placeholder: ="Select a date..."
            StartOfWeek: ="Sunday"
            StartYear: =1970
            ValidationState: ="None"
            Visible: =locShowPopup
            Width: =320
            X: =303
            Y: =435
            ZIndex: =28

        "calEndDate As 'Date picker'":
            AccessibleLabel: =Text("", "dd/mm/yyyy")
            BasePaletteColor: =
            DisplayMode: =DisplayMode.Edit
            EndYear: =2050
            FontSize: =0
            Format: ="Long Abbreviated"
            Height: =32
            IsEditable: =false
            Placeholder: ="Select a date..."
            StartOfWeek: ="Sunday"
            StartYear: =1970
            ValidationState: ="None"
            Visible: =locShowPopup
            Width: =320
            X: =731
            Y: =435
            ZIndex: =29

        txtStartDate As Text:
            Align: ="Start"
            AutoHeight: =false
            DisplayMode: =DisplayMode.Edit
            Height: =18
            Size: =15
            Text: |-
                ="Start Date:"
            VerticalAlign: ="Middle"
            Visible: =locShowPopup
            Width: =96
            X: =303
            Y: =409
            ZIndex: =30

        txtEndDate As Text:
            Align: ="Start"
            AutoHeight: =false
            DisplayMode: =DisplayMode.Edit
            Height: =18
            Size: =15
            Text: |-
                ="End Date:"
            VerticalAlign: ="Middle"
            Visible: =locShowPopup
            Width: =96
            X: =731
            Y: =409
            ZIndex: =31

    grpAudit As group:
        Height: =5
        Width: =5
        X: =20
        Y: =20
        ZIndex: =31

        IcoAudit As icon.Add:
            Color: =gblBranding.Colors.PrimaryColor1
            Height: =24
            Icon: =Icon.History
            OnSelect: |-
                =UpdateContext({locAuditShowPopup: true}); SetFocus(txtInputSearchAudit)
            Width: =24
            X: =979
            Y: =186
            ZIndex: =5

        txtAudit As Text:
            Align: ='TextCanvas.Align'.Center
            AutoHeight: =false
            DisplayMode: =DisplayMode.Edit
            Height: =19
            Size: =15
            Text: ="Audit"
            VerticalAlign: ="Middle"
            Weight: ='TextCanvas.Weight'.Semibold
            Width: =66
            Wrap: =true
            X: =1003
            Y: =186
            ZIndex: =6

    grpGlyPopUpAudit As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =37

        cmpGlyPopUpAudit As cmpGlyPopUp:
            pClose: |-
                =UpdateContext({locAuditShowPopup: false})
            pSubHeader: ="Audit - "&lblFirstName& " " &lblLastName
            Visible: =locAuditShowPopup
            ZIndex: =32

        glyTemplateBodyAudit As gallery.variableTemplateHeightGallery:
            FocusedBorderColor: =RGBA(98, 100, 167, 1)
            FocusedBorderThickness: =0
            Height: =279
            Items: |-
                =   Sort(
                        Filter(
                            DPM_Audits,
                            (
                            (txtInputSearchAudit.Text in CreatedByName || txtInputSearchAudit.Text in AuditTitle || txtInputSearchAudit.Text in AuditDescription|| txtInputSearchAudit.Text in MemberID || IsBlank(txtInputSearchAudit.Text))
                
                            && (MemberID=glyTemplateBodyMembers.Selected.MemberID || IsBlank(glyTemplateBodyMembers.Selected))
                        )),
                    'Created On',SortOrder.Descending)
            Layout: =Layout.Vertical
            ShowNavigation: =true
            ShowScrollbar: =false
            TemplateFill: =If(Self.IsSelected, ColorFade(RGBA(204, 204, 204, 1),80%), RGBA(0, 0, 0, 0))
            TemplateSize: =recMemberInfoAudit.Height
            Visible: =locAuditShowPopup
            Width: =923
            X: =221
            Y: =287
            ZIndex: =33

            recMemberInfoAudit As rectangle:
                BorderColor: =RGBA(204, 204, 204, 1)
                BorderThickness: =1
                DisplayMode: =DisplayMode.View
                Fill: =RGBA(255, 255, 255, 1)
                FocusedBorderColor: =RGBA(98, 100, 167, 1)
                Height: =50
                Width: =Parent.TemplateWidth
                ZIndex: =1

            lblTitle As Label:
                AutoHeight: =false
                Color: =
                DisplayMode: =DisplayMode.Edit
                Font: =Font.'Segoe UI'
                FontSize: =11
                FontWeight: =FontWeight.Normal
                Height: =50
                OnSelect: =Select(Parent)
                PCFTeamsTheme: ="default"
                Text: =ThisItem.AuditTitle
                VerticalAlignment: =VerticalAlign.Middle
                Width: =108
                X: =59
                Y: =0
                ZIndex: =2

            lblDescription As Label:
                AutoHeight: =false
                Color: =
                DisplayMode: =DisplayMode.Edit
                Font: =Font.'Segoe UI'
                FontSize: =11
                FontWeight: =FontWeight.Normal
                Height: =50
                OnSelect: =Select(Parent)
                PCFTeamsTheme: ="default"
                Text: =ThisItem.AuditDescription
                VerticalAlignment: =VerticalAlign.Middle
                Width: =461
                X: =197
                Y: =0
                ZIndex: =3

            lblCreatedBy As label:
                Font: =Font.'Segoe UI'
                Height: =50
                OnSelect: =Select(Parent)
                PaddingBottom: =0
                PaddingLeft: =0
                Size: =11
                Text: =ThisItem.CreatedByName
                Width: =80
                X: =673
                ZIndex: =4

            lblIDAudit As Label:
                AutoHeight: =false
                Color: =
                DisplayMode: =DisplayMode.Edit
                Font: =Font.'Segoe UI'
                FontSize: =11
                FontWeight: =FontWeight.Normal
                Height: =50
                OnSelect: =Select(Parent)
                PCFTeamsTheme: ="default"
                Text: =ThisItem.AuditID
                VerticalAlignment: =VerticalAlign.Middle
                Width: =46
                X: =1
                Y: =0
                ZIndex: =7

            lblCreatedOn As Label:
                AutoHeight: =false
                Color: =
                DisplayMode: =DisplayMode.Edit
                FontSize: =11
                FontWeight: =FontWeight.Normal
                Height: =50
                OnSelect: =Select(Parent)
                PCFTeamsTheme: ="default"
                Text: |-
                    =Text(ThisItem.'Created On',"dd/mm/yyy hh:mm")
                VerticalAlignment: =VerticalAlign.Middle
                Width: =127
                X: =785
                Y: =0
                ZIndex: =8

        glyTemplateHdrAudit As gallery.variableTemplateHeightGallery:
            FocusedBorderColor: =RGBA(98, 100, 167, 1)
            FocusedBorderThickness: =2
            Height: =41
            Items: |-
                ={MemberID:"ID",FirstName:"Title", LastName:"Description", StartDate:"Created By ", EndDate:"Created By Email"}
            Layout: =Layout.Vertical
            ShowScrollbar: =false
            TemplateSize: =40
            Visible: =locAuditShowPopup
            Width: =923
            X: =218
            Y: =251
            ZIndex: =34

            lblTitleHdrAudit As Label:
                Color: =
                DisplayMode: =DisplayMode.Edit
                FontSize: =11
                FontWeight: =FontWeight.Semibold
                Height: =35
                OnSelect: =Select(Parent)
                PCFTeamsTheme: ="default"
                Text: =ThisItem.FirstName
                Width: =130
                X: =60
                Y: =0
                ZIndex: =1

            lblDatetimeHdrAudit As Label:
                Color: =
                DisplayMode: =DisplayMode.Edit
                FontSize: =11
                FontWeight: =FontWeight.Semibold
                Height: =35
                OnSelect: =Select(Parent)
                PCFTeamsTheme: ="default"
                Text: =ThisItem.LastName
                Width: =120
                X: =197
                Y: =0
                ZIndex: =2

            lblDescriptionHdrAudit As Label:
                Color: =
                DisplayMode: =DisplayMode.Edit
                FontSize: =11
                FontWeight: =FontWeight.Semibold
                Height: =35
                OnSelect: =Select(Parent)
                PCFTeamsTheme: ="default"
                Text: =ThisItem.StartDate
                Width: =112
                X: =677
                Y: =0
                ZIndex: =3

            lblNameHdrAudit As Label:
                Color: =
                DisplayMode: =DisplayMode.Edit
                FontSize: =11
                FontWeight: =FontWeight.Semibold
                Height: =35
                OnSelect: =Select(Parent)
                PCFTeamsTheme: ="default"
                Text: =ThisItem.MemberID
                Width: =56
                X: =3
                Y: =0
                ZIndex: =5

            lblCreatedOnHdrAudit_1 As Label:
                Color: =
                DisplayMode: =DisplayMode.Edit
                FontSize: =11
                FontWeight: =FontWeight.Semibold
                Height: =35
                OnSelect: =Select(Parent)
                PCFTeamsTheme: ="default"
                Text: ="Created On" 
                Width: =112
                X: =787
                Y: =0
                ZIndex: =6

        recHomeUpperSeperatorAudit As rectangle:
            Fill: =gblBranding.Colors.PrimaryColor1
            Height: =1
            Visible: =locAuditShowPopup
            Width: =920
            X: =221
            Y: =250
            ZIndex: =35

        txtInputSearchAudit As text:
            BorderColor: =gblBranding.Colors.PrimaryColor1
            Clear: =true
            Default: =""
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(0, 0, 0, 0)
            DisabledFill: =RGBA(0, 0, 0, 0)
            FocusedBorderThickness: =2
            Font: =Font.'Segoe UI'
            Height: =23
            HintText: ="ðŸ”Ž filter"
            HoverBorderColor: =gblBranding.Colors.PrimaryColor1
            HoverColor: =
            HoverFill: =RGBA(0, 0, 0, 0)
            PressedBorderColor: =gblBranding.Colors.PrimaryColor1
            RadiusBottomLeft: =2
            RadiusBottomRight: =2
            RadiusTopLeft: =2
            RadiusTopRight: =2
            Size: =11
            Visible: =locAuditShowPopup
            Width: =259
            X: =221
            Y: =220
            ZIndex: =36

    grpViewDocPopUp As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =37

        cmpGlyPopUp_1 As cmpGlyPopUp:
            pClose: |-
                =UpdateContext({locDocShowPopUp:false})
            pSubHeader: ="Employee Documents - "& glyTemplateBodyMembers.Selected.FirstName&" "&glyTemplateBodyMembers.Selected.LastName
            Visible: =locDocShowPopUp
            ZIndex: =14

        "glyEmployeeDoc As gallery.'BrowseLayout_Vertical_OneTextVariant_ver4.0'":
            Height: =230
            Items: =Filter('Employment Contracts',glyTemplateBodyMembers.Selected.MemberID = MemberID)
            Layout: =Layout.Vertical
            TemplatePadding: =0
            TemplateSize: =Min(96, Self.Height - 60)
            Visible: =locDocShowPopUp
            Width: =919
            X: =222
            Y: =221
            ZIndex: =38

            lblDocName As label:
                Font: =Font.'Segoe UI'
                Height: =Self.Size * 1.8
                OnSelect: =Select(Parent)
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                Size: =15
                Text: =ThisItem.Title
                VerticalAlign: =VerticalAlign.Top
                Width: =Parent.TemplateWidth - 104
                X: =32
                Y: =(Parent.TemplateHeight / 2) - (Self.Height / 2)
                ZIndex: =1

            icoViewDoc As icon.ChevronRight:
                AccessibleLabel: =Self.Tooltip
                Height: =44
                Icon: =Icon.View
                OnSelect: =Select(Parent); Launch(ThisItem.'Link to item')
                PaddingBottom: =10
                PaddingLeft: =10
                PaddingRight: =10
                PaddingTop: =10
                TabIndex: =0
                Tooltip: ="View item details"
                Width: =51
                X: =836
                Y: =26
                ZIndex: =2

            recEmployeeDocSep As rectangle:
                Height: =1
                OnSelect: =Select(Parent)
                Width: =Parent.TemplateWidth
                Y: =Parent.TemplateHeight - 1
                ZIndex: =3

    grpEditForm As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =38

        cmpHomeEditForm As cmpGlyPopUp:
            pClose: |-
                =UpdateContext({locShowPopup1: false})
            pSubHeader: ="Edit Member"
            Visible: =locShowPopup1
            ZIndex: =12

        "txtInputFirstNameEdit As 'Text input'":
            BasePaletteColor: =
            DisplayMode: =DisplayMode.Edit
            FontSize: =0
            Height: =32
            MaxLength: =-1
            Placeholder: =""
            Required: =true
            Type: ="Text"
            ValidationState: ="None"
            Value: =glyTemplateBodyMembers.Selected.FirstName
            Visible: =locShowPopup1
            Width: =320
            X: =312
            Y: =265
            ZIndex: =15

        "txtInputLastNameEdit As 'Text input'":
            BasePaletteColor: =
            DisplayMode: =DisplayMode.Edit
            FontSize: =0
            Height: =32
            MaxLength: =-1
            Placeholder: =""
            Required: =true
            Type: ="Text"
            ValidationState: ="None"
            Value: =glyTemplateBodyMembers.Selected.LastName
            Visible: =locShowPopup1
            Width: =320
            X: =740
            Y: =265
            ZIndex: =16

        txtFirstNameEdit As Text:
            Align: ="Start"
            AutoHeight: =false
            DisplayMode: =DisplayMode.Edit
            Height: =18
            Size: =15
            Text: |-
                ="First Name:"
            VerticalAlign: ="Middle"
            Visible: =locShowPopup1
            Width: =96
            X: =312
            Y: =243
            ZIndex: =17

        txtLastNameEdit As Text:
            Align: ="Start"
            AutoHeight: =false
            DisplayMode: =DisplayMode.Edit
            Height: =18
            Size: =15
            Text: |-
                ="Last Name:"
            VerticalAlign: ="Middle"
            Visible: =locShowPopup1
            Width: =96
            X: =743
            Y: =243
            ZIndex: =18

        "calStartDateEdit As 'Date picker'":
            BasePaletteColor: =
            DisplayMode: =DisplayMode.Edit
            EndYear: =2050
            FontSize: =0
            Format: ="Long Abbreviated"
            Height: =32
            IsEditable: =false
            Placeholder: ="Select a date..."
            Required: =true
            StartOfWeek: ="Sunday"
            StartYear: =1970
            ValidationState: ="None"
            Visible: =locShowPopup1
            Width: =320
            X: =312
            Y: =346
            ZIndex: =19

        "calEndDateEdit As 'Date picker'":
            AccessibleLabel: =""
            BasePaletteColor: =
            DisplayMode: =DisplayMode.Edit
            EndYear: =2050
            FontSize: =0
            Format: ="Long Abbreviated"
            Height: =32
            IsEditable: =false
            Placeholder: ="Select a date..."
            StartOfWeek: ="Sunday"
            StartYear: =1970
            ValidationState: ="None"
            Visible: =locShowPopup1
            Width: =320
            X: =740
            Y: =346
            ZIndex: =20

        txtStartDateEdit As Text:
            Align: ="Start"
            AutoHeight: =false
            DisplayMode: =DisplayMode.Edit
            Height: =18
            Size: =15
            Text: |-
                ="Start Date:"
            VerticalAlign: ="Middle"
            Visible: =locShowPopup1
            Width: =96
            X: =312
            Y: =320
            ZIndex: =21

        txtEndDateEdit As Text:
            Align: ="Start"
            AutoHeight: =false
            DisplayMode: =DisplayMode.Edit
            Height: =18
            Size: =15
            Text: |-
                ="End Date:"
            VerticalAlign: ="Middle"
            Visible: =locShowPopup1
            Width: =96
            X: =740
            Y: =320
            ZIndex: =22

        attEmploymentDoc As attachments:
            AddAttachmentText: ="Upload file"
            BorderColor: =gblBranding.Colors.PrimaryColor1
            Font: =Font.'Segoe UI'
            Height: =105
            IsInDataCard: =true
            Items: =
            MaxAttachments: =5
            MaxAttachmentsText: =""
            NoAttachmentsText: ="There is no file."
            PaddingBottom: =5
            PaddingLeft: =If(Self.DisplayMode = DisplayMode.Edit, 5, 0)
            PaddingRight: =5
            PaddingTop: =5
            Tooltip: =
            Visible: =locShowPopup1
            Width: =742
            X: =315
            Y: =435
            ZIndex: =37

        btnEditConfirm As Button:
            Appearance: ='ButtonCanvas.Appearance'.Primary
            BasePaletteColor: =
            DisplayMode: =DisplayMode.Edit
            FontSize: =0
            Height: =34
            OnSelect: |-
                =UpdateContext({locShowSpinner: true});
                Patch(
                    DPM_Members,
                    LookUp(
                        DPM_Members,
                        (MemberID = glyTemplateBodyMembers.Selected.MemberID)
                    ),
                    {
                        FirstName: txtInputFirstNameEdit.Value,
                        LastName: txtInputLastNameEdit.Value,
                        StartDate: calStartDateEdit.SelectedDate,
                        EndDate: calEndDateEdit.SelectedDate
                    }
                ); ForAll(attEmploymentDoc.Attachments,DPM_UploadEmploymentDocumentation.Run(gblCurrentMember.MemberID,{file: {name: ThisRecord.Name,contentBytes: ThisRecord.Value}}));
                Patch(
                    DPM_Audits,
                    Defaults(DPM_Audits),
                    {
                        AuditTitle: "Member Edited",
                        AuditDescription: "" & User().FullName & " edited " & lblFirstName & " " & lblLastName & " " & txtInputLastName.Value & " on " & Text(
                            Now(),
                            "dd/mm/yyyy  hh:mm"
                        ),
                        CreatedByName: User().FullName,
                        CreatedByEmail: Lower(User().Email),
                        MemberID: gblCurrentMember.MemberID
                    }
                );
                UpdateContext({locShowPopup1: false, locShowSpinner:false})
            Text: ="Confirm"
            Visible: =locShowPopup1
            Width: =126
            X: =1024
            Y: =577
            ZIndex: =39

    spmHome As Spinner:
        AccessibleLabel: =""
        Appearance: ='Spinner.Appearance'.Primary
        BasePaletteColor: =
        DisplayMode: =DisplayMode.Edit
        FontSize: =0
        Height: =768
        Label: ="Loading..."
        SpinnerSize: ='Spinner.SpinnerSize'.Huge
        Visible: =locShowSpinner
        Width: =1366
        X: =0
        Y: =0
        ZIndex: =40

    lblNoDocuments As label:
        Align: =Align.Center
        Color: =Color.DarkGray
        Font: =Font.'Segoe UI'
        Height: =68
        Size: =15
        Text: ="No Employee Documents"
        Visible: =locDocShowPopUp && CountRows(glyEmployeeDoc.AllItems)=0
        Width: =187
        X: =586
        Y: =392
        ZIndex: =41

